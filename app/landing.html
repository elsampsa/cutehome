<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Home Page</title>
    <link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../lib/include/bootstrap-icons/css/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../lib/include/fontawesome/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --font-body: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            --font-mono: 'JetBrains Mono', 'Courier New', monospace;
        }

        body {
            font-family: var(--font-body);
            font-weight: 400;
            line-height: 1.6;
            position: relative;
        }

        /* Blurred background image */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('./content/photos/donosti.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            filter: blur(10px);
            opacity: 0.15;
            z-index: -1;
        }

        code, pre {
            font-family: var(--font-mono);
        }

        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.3;
        }

        /* Prevent horizontal shift when switching between sections */
        html {
            overflow-y: scroll;  /* Always show scrollbar space */
        }

        #sidebar {
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(255, 255, 255, .1);
        }

        #main-content {
            padding: 2rem;
        }

        /* Desktop: sticky sidebar that floats in place */
        @media (min-width: 768px) {
            #sidebar {
                position: sticky;
                top: 0;
                max-height: 100vh;
                overflow-y: auto;
            }
        }

        /* Mobile adjustments */
        @media (max-width: 767px) {
            #sidebar {
                padding: 0;
            }
        }

        /* Markdown content styling */
        .container img {
            display: block;
            margin-left: auto;
            margin-right: auto;
            max-width: 100%;
            height: auto;
        }

        /* Center images on wide screens, but limit width */
        @media (min-width: 768px) {
            .container img {
                max-width: 600px;
            }
        }

        /* Style the paragraph that contains an image */
        .container p:has(> img) {
            text-align: center;
        }

        /* Caption styling */
        .container .image-caption {
            display: block;
            text-align: center;
            font-style: italic;
            color: #6c757d;
            margin-top: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row">
            <div id="sidebar" class="col-12 col-md-3"></div>
            <div id="main-content" class="col-12 col-md-9"></div>
        </div>
    </div>

    <script src="../lib/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="../lib/include/marked/js/marked.min.js"></script>

    <script type="module">
        import { SidebarMenu } from '../lib/base/sidebarwidget.js';
        import { ContainerWidget } from '../lib/base/containerwidget.js';
        import { StateWidget } from '../lib/base/statewidget.js';
        import { MarkdownSection } from './lib/markdownsection.js';
        import { SlideShowWidget } from './lib/slideshow.js';
        import { SiteRouter } from './lib/siterouter.js';

        // 1. Create all widgets explicitly (only for pages, not folders)
        const aboutMeSection = new MarkdownSection(null);
        aboutMeSection.setMarkdownFile('./content/about-me/aboutme.md');
        aboutMeSection.setLogLevel(-1);

        const openSourceSection = new MarkdownSection(null);
        openSourceSection.setMarkdownFile('./content/opensource/opensource.md');
        openSourceSection.setLogLevel(-1);

        const scienceSection = new MarkdownSection(null);
        scienceSection.setMarkdownFile('./content/science/science.md');
        scienceSection.setLogLevel(-1);

        const linksSection = new MarkdownSection(null);
        linksSection.setMarkdownFile('./content/links/links.md');
        linksSection.setLogLevel(-1);

        const photosSection = new SlideShowWidget(null);
        // photosSection.simulateSlowDownload(3000);
        photosSection.setLogLevel(-1);
        photosSection.setSlides([
            {
                src: './content/photos/me_istanbul06.jpg',
                caption: 'Me in 2006',
                alt: 'Photo 1'
            },
            {
                src: './content/photos/me_eva_istanbul06.jpg',
                caption: 'Me and my future wife in 2006',
                alt: 'Photo 2'
            },
            {
                src: './content/photos/av_navarra06.jpg',
                caption: 'The Avenida de Navarra 30 shared flat in 2006',
                alt: 'Photo 2'
            },
            {
                src: './content/photos/pasajes16.jpg',
                caption: 'Climbing in Basque Country in 2016',
                alt: 'Photo 3'
            },
            {
                src: './content/photos/donosti2.jpg',
                caption: 'San Sebastián',
                alt: 'Photo 3'
            },
            {
                src: './content/photos/kids17.jpg',
                caption: 'Kids in 2017',
                alt: 'Photo 3'
            },
            {
                src: './content/photos/funland17.jpg',
                caption: 'Funland in 2017',
                alt: 'Photo 3'
            },
            {
                src: './content/photos/vuosaari21.jpg',
                caption: 'Our natural habitat in 2021',
                alt: 'Photo 4'
            },
            {
                src: './content/photos/boat_21.jpg',
                caption: 'Pandemic year fun',
                alt: 'Photo 5'
            },
            {
                src: './content/photos/chiquis21.jpg',
                caption: 'Kids in 2021',
                alt: 'Photo 6'
            },
            {
                src: './content/photos/artikutxa.jpg',
                caption: 'Somewhere in the Basque Country in 2024',
                alt: 'Photo 7'
            },
            {
                src: './content/photos/in_andorra.jpg',
                caption: 'Life in Andorra',
                alt: 'Photo 8'
            },
            {
                src: './content/photos/junclar23.jpg',
                caption: 'Somewhere in Andorra in 2023',
                alt: 'Photo 9'
            },
            {
                src: './content/photos/climb_nacho_andorra24.jpg',
                caption: 'Andorra fun in 2024',
                alt: 'Photo 9'
            },
            {
                src: './content/photos/san_silvestre24.jpg',
                caption: 'San Silvestre popular race in 2024 with Iñaki',
                alt: 'Photo 10'
            },
            {
                src: './content/photos/oudie.jpg',
                caption: 'Oudie',
                alt: 'Photo 11'
            }
        ]);

        // 2. Define site structure with explicit widget references
        // You can cross-reference the md files with
        // [Link Text](nav:id)
        // i.e.: [Academic](nav:science)
        const siteConfig = {
            defaultSection: "about-me",  // Navigate here on page load
            sections: [
                {
                    id: "about-me",
                    label: "About Me",
                    icon: "fas fa-user",
                    widget: aboutMeSection  // Leaf node - has content
                },
                /* // subfolders like this:
                {
                    id: "opensource",
                    label: "OpenSource",
                    icon: "fas fa-code-branch",
                    // NO widget - this is a folder node
                    sections: [
                        {
                            id: "cutefront",
                            label: "CuteFront",
                            widget: cuteFrontSection  // Leaf node - has content
                        }
                    ]
                }
                */
                {
                    id: "opensource",
                    label: "OS Projects",
                    icon: "fas fa-code-branch",
                    widget: openSourceSection
                },
                {
                    id: "science",
                    label: "Academic",
                    icon: "fas fa-flask",
                    widget: scienceSection
                },
                {
                    id: "photos",
                    label: "Photos",
                    icon: "fas fa-camera",
                    widget: photosSection
                },
                {
                    id: "links",
                    label: "Links",
                    icon: "fas fa-link",
                    widget: linksSection
                },
            ]
        };

        // 3. Create sidebar and container
        const sidebar = new SidebarMenu("sidebar");
        sidebar.setLogLevel(-1);

        const container = new ContainerWidget("main-content");
        container.setLogLevel(-1);

        // 4. Create router and let it handle everything
        const router = new SiteRouter(siteConfig, sidebar, container);
        router.setLogLevel(-1);

        // 5. Enable URL-based navigation with StateWidget
        router.setSerializationKey("section");  // Creates URLs like ?section=about-me
        router.setSerializationWrite(true);     // Enable writing to browser history
        const stateWidget = new StateWidget();
        stateWidget.setLogLevel(-1);
        stateWidget.register(router);  // Register router for state management

        window.genDocs = ["sidebar", "container", "router", "stateWidget"];
    </script>
</body>
</html>
